import{_ as i}from"./chunks/001.CqXd7Btp.js";import{_ as a,a as e}from"./chunks/003.DlC5wTuP.js";import{_ as n,c as l,o as t,a0 as p}from"./chunks/framework.zS86-xgI.js";const h="/note-operator/operations/simulate/cygwin/soft/004.png",o="/note-operator/operations/simulate/cygwin/soft/005.png",d="/note-operator/operations/simulate/cygwin/soft/006.png",r="/note-operator/operations/simulate/cygwin/soft/007.png",_=JSON.parse('{"title":"一、Cygwin编译Redis","description":"","frontmatter":{},"headers":[],"relativePath":"markdown/operations/simulate/cygwin/soft/01.md","filePath":"markdown/operations/simulate/cygwin/soft/01.md"}'),k={name:"markdown/operations/simulate/cygwin/soft/01.md"};function c(g,s,y,m,F,u){return t(),l("div",null,s[0]||(s[0]=[p('<h1 id="一、cygwin编译redis" tabindex="-1">一、Cygwin编译Redis <a class="header-anchor" href="#一、cygwin编译redis" aria-label="Permalink to &quot;一、Cygwin编译Redis&quot;">​</a></h1><h2 id="_1-1-redis源码下载" tabindex="-1">1.1 redis源码下载 <a class="header-anchor" href="#_1-1-redis源码下载" aria-label="Permalink to &quot;1.1 redis源码下载&quot;">​</a></h2><ol><li>下载软件包</li></ol><p><a href="https://github.com/redis/redis/releases" target="_blank" rel="noreferrer">github地址</a></p><p><img src="'+i+'" alt="" data-fancybox="gallery"></p><ol start="2"><li>Cygwin组件包下载 mintty, make，gcc-core，gcc-g++, libgcc1, libgccpp1、procps-ng、tcl、pkg-config</li></ol><h2 id="_2-软件包复制到home目录下" tabindex="-1">2. 软件包复制到home目录下 <a class="header-anchor" href="#_2-软件包复制到home目录下" aria-label="Permalink to &quot;2. 软件包复制到home目录下&quot;">​</a></h2><ul><li>软件目录</li></ul><p><code>F:\\cygwin\\cygwin64</code></p><ul><li>home目录</li></ul><p><code>F:\\cygwin\\cygwin64\\home\\zhaojianhui</code></p><p><img src="'+a+'" alt="" data-fancybox="gallery"></p><h2 id="_3-cygwin可能出现的问题" tabindex="-1">3. Cygwin可能出现的问题 <a class="header-anchor" href="#_3-cygwin可能出现的问题" aria-label="Permalink to &quot;3. Cygwin可能出现的问题&quot;">​</a></h2><ol><li>window 正在查找mintty</li></ol><p>安装后在桌面上点击快捷方式<code>Cygwin64 Terminal</code>图标时，提示 Windows正在查找mintty</p><p>具体原因是: 在安装Cygwin时没有选择安装mintty库</p><p>解决方法：重装</p><ol start="2"><li>debug.c:1925:5: error: unknown type name <code>Dl_info</code></li></ol><p>编译redis6以上源码要先修改cygwin一个文件，否则无法编译。</p><p>进入cygwin安装目录的<code>usr/include</code>目录下，找到<code>dlfcn.h</code>，找到<code>#if __GNU_VISIBLE</code>及其后面紧跟的<code>#endif</code>这两行，然后将这两行注释掉保存即可</p><p><img src="'+e+`" alt="" data-fancybox="gallery"></p><h2 id="_4-解压与编译" tabindex="-1">4. 解压与编译 <a class="header-anchor" href="#_4-解压与编译" aria-label="Permalink to &quot;4. 解压与编译&quot;">​</a></h2><ol><li>打开<code>Cygwin Terminal</code>并执行下面的命令</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入目录</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/zhaojianhui/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解压</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -zxvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis-7.4.4.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入目录</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis-7.4.4</span></span></code></pre></div><ol start="2"><li>编译redis依赖</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入deps目录</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deps</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 编译依赖，除了jemalloc不编译，其他文件夹都编译</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hiredis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lua</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hdr_histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fpconv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> linenoise</span></span></code></pre></div><blockquote><p>注意：编译hiredis时，需要修改sds.c文件中的875行的hi_sdscatrepr方法，将入参由<code>const char *p</code>改为 <code>const unsigned char *p</code>。同样的方法修改sds.h文件中的方法定义。</p></blockquote><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hisds </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hi_sdscatrepr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hisds </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ol start="3"><li>编译redis</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入 软件目录 /home/zhaojianhui/redis-7.4.4</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ..</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 编译redis且安装</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span></code></pre></div><p><img src="`+h+'" alt="" data-fancybox="gallery"></p><h2 id="_5-复制文件并运行" tabindex="-1">5. 复制文件并运行 <a class="header-anchor" href="#_5-复制文件并运行" aria-label="Permalink to &quot;5. 复制文件并运行&quot;">​</a></h2><ol><li>新建软件目录</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">oft</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">edis7.4.4</span></span></code></pre></div><ol start="2"><li>复制exe执行文件</li></ol><p>复制编译后的exe文件(存放在redis-7.0.4\\src目录下)</p><p><img src="'+o+'" alt="" data-fancybox="gallery"></p><ol start="3"><li>复制配置文件</li></ol><p>复制redis-7.4.4源码目录下的redis.conf与sentinel.conf</p><p><img src="'+d+'" alt="" data-fancybox="gallery"></p><ol start="4"><li>复制cygwin1.dll</li></ol><p>复制出来的这些exe文件是无法在windows环境执行的。要想执行这些exe文件必须借助cygwin1.dll来执行</p><p>复制<code>F:\\cygwin\\cygwin64\\bin\\cygwin1.dll</code> 到 软件目录</p><p><img src="'+r+`" alt="" data-fancybox="gallery"></p><h2 id="_6-运行软件" tabindex="-1">6. 运行软件 <a class="header-anchor" href="#_6-运行软件" aria-label="Permalink to &quot;6. 运行软件&quot;">​</a></h2><ol><li>简单修改配置文件</li></ol><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ip地址</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bind 0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 端口号</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">port 6379</span></span></code></pre></div><ol start="2"><li>启动服务端</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis-conf</span></span></code></pre></div><ol start="3"><li>连接客户端</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-cli</span></span></code></pre></div>`,51)]))}const v=n(k,[["render",c]]);export{_ as __pageData,v as default};

import{_ as n,c as l,o as p,a0 as e}from"./chunks/framework.zS86-xgI.js";const h="/note-operator/other/install/jenkins/065.png",k="/note-operator/other/install/jenkins/066.png",r="/note-operator/other/install/jenkins/067.png",o="/note-operator/other/install/jenkins/068.png",d="/note-operator/other/install/jenkins/069.png",g="/note-operator/other/install/jenkins/070.png",c="/note-operator/other/install/jenkins/071.png",y="/note-operator/other/install/jenkins/072.png",i="/note-operator/other/install/jenkins/073.png",F="/note-operator/other/install/jenkins/075.png",C="/note-operator/other/install/jenkins/076.png",b="/note-operator/other/install/jenkins/087.png",u="/note-operator/other/install/jenkins/077.png",E="/note-operator/other/install/jenkins/082.png",m="/note-operator/other/install/jenkins/078.png",B="/note-operator/other/install/jenkins/079.png",a="/note-operator/other/install/jenkins/080.png",t="/note-operator/other/install/jenkins/083.png",_="/note-operator/other/install/jenkins/085.png",v="/note-operator/other/install/jenkins/086.png",x="/note-operator/other/install/jenkins/088.png",A="/note-operator/other/install/jenkins/089.png",j="/note-operator/other/install/jenkins/090.png",D="/note-operator/other/install/jenkins/091.png",f="/note-operator/other/install/jenkins/092.png",q="/note-operator/other/install/jenkins/093.png",H="/note-operator/other/install/jenkins/094.png",S="/note-operator/other/install/jenkins/095.png",J="/note-operator/other/install/jenkins/104.png",P="/note-operator/other/install/jenkins/096.png",T="/note-operator/other/install/jenkins/097.png",w="/note-operator/other/install/jenkins/098.png",N="/note-operator/other/install/jenkins/099.png",$="/note-operator/other/install/jenkins/101.png",G="/note-operator/other/install/jenkins/102.png",R="/note-operator/other/install/jenkins/100.png",O="/note-operator/other/install/jenkins/103.png",I="/note-operator/other/install/jenkins/105.png",Q=JSON.parse('{"title":"二、jenkins 高级配置","description":"","frontmatter":{},"headers":[],"relativePath":"markdown/other/install/Jenkins/02.md","filePath":"markdown/other/install/Jenkins/02.md"}'),M={name:"markdown/other/install/Jenkins/02.md"};function W(L,s,U,z,K,V){return p(),l("div",null,s[0]||(s[0]=[e('<h1 id="二、jenkins-高级配置" tabindex="-1">二、jenkins 高级配置 <a class="header-anchor" href="#二、jenkins-高级配置" aria-label="Permalink to &quot;二、jenkins 高级配置&quot;">​</a></h1><h2 id="_2-1-publishers-超时机制" tabindex="-1">2.1 publishers 超时机制 <a class="header-anchor" href="#_2-1-publishers-超时机制" aria-label="Permalink to &quot;2.1 publishers 超时机制&quot;">​</a></h2><ol><li><p>超时时间设置</p><blockquote><p>如果一个项目比较大，或者连接数据库初始加载数据比较慢，都要设置一个比较大的时间</p></blockquote><p><img src="'+h+'" alt="" data-fancybox="gallery"></p></li><li><p>执行命令要有返回结果</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nohup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/xxoo/java-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.jar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span></span></code></pre></div><p><img src="'+k+`" alt="" data-fancybox="gallery"></p></li><li><p>修改命令</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nohup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/xxoo/java-demo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.jar</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mylog.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 2&gt;&amp;1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nohup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/xxoo/java-demo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.jar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mylog.log &amp;</span></span></code></pre></div></li><li><p>修改后的构建结果</p><p><img src="`+r+'" alt="" data-fancybox="gallery"></p></li></ol><h2 id="_2-2-前置脚本" tabindex="-1">2.2 前置脚本 <a class="header-anchor" href="#_2-2-前置脚本" aria-label="Permalink to &quot;2.2 前置脚本&quot;">​</a></h2><ol><li><p>添加前置处理命令</p><p><img src="'+o+'" alt="" data-fancybox="gallery"></p><p><img src="'+d+`" alt="" data-fancybox="gallery"></p></li><li><p>添加 clear.sh 脚本</p><ul><li><p>新建脚本</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 添加脚本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clear.sh</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 添加权限</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 755</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clear.sh</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试脚本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./clear.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java-demo</span></span></code></pre></div></li><li><p>脚本文件</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取传入的参数</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;arg:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取正在运行的jar包pid</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ps</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;java -jar&#39; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $2}&#39;\`</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $pid</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 如果pid为空，提示一下，否则，执行kill命令</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用-z 做空值判断</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-z</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $pid ];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not started&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	kill</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $pid</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stoping...&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span></code></pre></div></li><li><p>测试结果</p><p><img src="`+g+'" alt="" data-fancybox="gallery"></p></li></ul></li><li><p>重新构建</p><p><img src="'+c+'" alt="" data-fancybox="gallery"></p></li></ol><h2 id="_2-3-构建触发器" tabindex="-1">2.3 构建触发器 <a class="header-anchor" href="#_2-3-构建触发器" aria-label="Permalink to &quot;2.3 构建触发器&quot;">​</a></h2><h3 id="_2-3-1-jenkins-自动化构建触发方式" tabindex="-1">2.3.1 Jenkins 自动化构建触发方式 <a class="header-anchor" href="#_2-3-1-jenkins-自动化构建触发方式" aria-label="Permalink to &quot;2.3.1  Jenkins 自动化构建触发方式&quot;">​</a></h3><ol><li><p>快照依赖构建</p><ul><li><p><strong>机制</strong>：当项目所依赖的某个 <strong>SNAPSHOT 版本</strong>​ 的构件被更新并构建后，自动触发当前项目的构建。</p></li><li><p><strong>适用场景</strong>：多模块项目或微服务架构中，确保依赖的“快照”版本变更后，下游项目能立即重新构建并集成。</p></li><li><p><strong>配置提示</strong>：需在 Jenkins 项目配置的 **“构建触发器”**​ 中勾选对应选项，并确保依赖项目与当前项目在同一 Jenkins 中或可被感知。</p></li></ul></li><li><p>触发远程构建</p><ul><li><p><strong>机制</strong>：通过调用 Jenkins 提供的 <strong>REST API</strong>​ 来手动或编程式触发构建。</p></li><li><p><strong>适用场景</strong>：</p><ul><li><p>外部系统事件需要触发构建（如：外部监控告警、手动脚本执行）。</p></li><li><p>与其他自动化工具（如运维脚本、测试平台）集成。</p></li></ul></li><li><p><strong>配置提示</strong>：</p><ol><li><p>在项目配置中启用 <strong>“触发远程构建”</strong>，并设置可选的令牌（Token）。</p></li><li><p>使用 <code>curl</code>等工具发送请求：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://JENKINS_URL/job/JOB_NAME/build?token=TOKEN</span></span></code></pre></div></li></ol></li></ul></li><li><p>Job 依赖构建</p><ul><li><p><strong>机制</strong>：当指定的上游项目（其他 Job）构建完成后，自动触发当前项目的构建。</p></li><li><p><strong>适用场景</strong>：流水线中明确的前后依赖关系，如先编译、再测试、最后部署的链式触发。</p></li><li><p><strong>配置提示</strong>：在 **“构建触发器”**​ 中选择 <strong>“Build after other projects are built”</strong>，并填写上游项目的名称。</p></li></ul></li><li><p>定时构建</p><ul><li><p><strong>机制</strong>：使用 <strong>Cron 表达式</strong>​ 设置固定的时间计划，无论代码是否有变更，到时间即触发构建。</p></li><li><p><strong>适用场景</strong>：</p><ul><li><p>定期生成夜间构建（Nightly Builds）。</p></li><li><p>周期性执行集成测试或代码质量扫描。</p></li></ul></li><li><p><strong>配置提示</strong>：</p><ul><li><p>表达式示例：<code>H 2 * * *</code>（每天凌晨 2 点执行）。</p></li><li><p>可在输入框旁点击 **“？”**​ 查看 Jenkins 提供的 Cron 语法帮助。</p></li></ul></li></ul></li><li><p>GitHub 提交代码触发构建</p><ul><li><p><strong>机制</strong>：通过 <strong>GitHub Webhook</strong>，在代码推送到仓库时，GitHub 自动通知 Jenkins 触发构建。</p></li><li><p><strong>适用场景</strong>：典型的 CI 场景，实现“提交即构建”。</p></li><li><p><strong>配置提示</strong>：</p><ol><li><p>在 GitHub 仓库设置中添加 Webhook，指向 <code>JENKINS_URL/github-webhook/</code>。</p></li><li><p>在 Jenkins 项目配置中勾选 <strong>“GitHub hook trigger for GITScm polling”</strong>。</p></li></ol></li></ul></li><li><p>定期检查代码变更</p><ul><li><p><strong>机制</strong>：结合 <strong>Cron 表达式</strong>​ 与 <strong>SCM 轮询</strong>，定期检查版本控制系统中是否有新提交，若有变更则触发构建。</p></li><li><p><strong>适用场景</strong>：当无法使用 Webhook（如 Git 仓库不支持或网络限制）时，作为替代方案。</p></li><li><p><strong>配置提示</strong>：</p><ul><li><p>在 **“构建触发器”**​ 中选择 <strong>“Poll SCM”</strong>。</p></li><li><p>表达式示例：<code>*/5 * * * *</code>（每 5 分钟检查一次变更）。</p></li></ul></li></ul></li><li><p><strong>总结与建议</strong></p><table tabindex="0"><thead><tr><th>构建方式</th><th>触发条件</th><th>推荐场景</th></tr></thead><tbody><tr><td><strong>快照依赖构建</strong>​</td><td>依赖的 SNAPSHOT 更新</td><td>多模块项目协作</td></tr><tr><td><strong>触发远程构建</strong>​</td><td>REST API 调用</td><td>与外部系统集成</td></tr><tr><td><strong>Job 依赖构建</strong>​</td><td>上游 Job 完成</td><td>明确的流水线依赖</td></tr><tr><td><strong>定时构建</strong>​</td><td>时间计划（Cron）</td><td>定期任务（如夜间构建）</td></tr><tr><td><strong>GitHub 提交触发</strong>​</td><td>GitHub Webhook</td><td>标准的 GitOps 流程</td></tr><tr><td><strong>定期检查代码变更</strong>​</td><td>SCM 轮询 + Cron</td><td>无法使用 Webhook 时</td></tr></tbody></table></li></ol><h3 id="_2-3-2-触发远程构建" tabindex="-1">2.3.2 触发远程构建 <a class="header-anchor" href="#_2-3-2-触发远程构建" aria-label="Permalink to &quot;2.3.2 触发远程构建&quot;">​</a></h3><ol><li><p>基础使用</p><ul><li><p>设置令牌</p><p><img src="'+y+'" alt="" data-fancybox="gallery"></p></li><li><p>URL调用</p><p><img src="'+i+'" alt="" data-fancybox="gallery"></p></li><li><p>调用结果</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>http://192.168.18.82:8080/job/first/build?token=123456</span></span></code></pre></div><p><img src="'+i+'" alt="" data-fancybox="gallery"></p></li><li><p>限制问题</p><p><img src="'+F+'" alt="" data-fancybox="gallery"></p><p>浏览器必须已经登录了jenkins，使用浏览器调用，否则不会触发</p></li></ul></li><li><p>解决方案：使用 <code>Build Authorization Token Root</code></p><ul><li><p>安装插件</p><p><img src="'+C+'" alt="" data-fancybox="gallery"></p></li><li><p>获取地址</p><p><img src="'+b+'" alt="" data-fancybox="gallery"></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>http://192.168.18.82:8080/buildByToken/build?job=first&amp;token=123456</span></span></code></pre></div></li><li><p>验证无登录是否解决</p><p><img src="'+u+'" alt="" data-fancybox="gallery"></p></li></ul></li><li><p>再gitlab中的webhooks中设置触发调用</p><ul><li><p>设置可以集成本地网络</p><ol><li><p>进入 GitLab 管理区域：</p><p>管理员账号 → Admin Area​ → Settings​ → Network</p></li><li><p>展开 &quot;Outbound requests&quot;​ 部分</p></li><li><p>勾选： <code>Allow requests to the local network from hooks and services</code></p></li><li><p>点击 Save changes</p></li></ol><p><img src="'+E+'" alt="" data-fancybox="gallery"></p></li><li><p>webhooks 设置</p><p><strong>找到webhooks</strong></p><p><img src="'+m+'" alt="" data-fancybox="gallery"></p><p><strong>设置触发的URL</strong></p><p><img src="'+B+'" alt="" data-fancybox="gallery"></p><p><strong>选择提交与合并</strong></p><p><img src="'+a+'" alt="" data-fancybox="gallery"></p><p><strong>取消SSL并选择添加webhooks</strong></p><p><img src="'+a+`" alt="" data-fancybox="gallery"></p></li><li><p>验证结果</p><ul><li><p>java代码</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HelloController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RequestMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hello</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hello World！！ update&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>选择合并</p><p><img src="`+t+'" alt="" data-fancybox="gallery"></p></li><li><p>合并后 jenkins触发的构建</p><p><img src="'+t+'" alt="" data-fancybox="gallery"></p><blockquote><p>可以看到触发了两次，一次是发起合并请求，一次是审批完成进行合并，并不是太好准确</p></blockquote></li><li><p>浏览器访问重新构建的项目</p><p><img src="'+_+'" alt="" data-fancybox="gallery"></p></li></ul></li></ul></li></ol><h3 id="_2-3-3-定时构建" tabindex="-1">2.3.3 定时构建 <a class="header-anchor" href="#_2-3-3-定时构建" aria-label="Permalink to &quot;2.3.3 定时构建&quot;">​</a></h3><ol><li><p>修改地址</p><p><img src="'+v+`" alt="" data-fancybox="gallery"></p></li><li><p>jenkins中的cron表达式</p><ol><li><p>基本格式</p><p>Jenkins的Cron表达式包含5个字段，格式为：</p><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">分 时 日 月 周</span></span></code></pre></div><table tabindex="0"><thead><tr><th>字段</th><th>取值范围</th><th>说明</th></tr></thead><tbody><tr><td><strong>分</strong>​</td><td>0-59</td><td>分钟</td></tr><tr><td><strong>时</strong>​</td><td>0-23</td><td>小时</td></tr><tr><td><strong>日</strong>​</td><td>1-31</td><td>月份中的日期</td></tr><tr><td><strong>月</strong>​</td><td>1-12</td><td>月份</td></tr><tr><td><strong>周</strong>​</td><td>0-7</td><td>星期几（0和7都表示周日）</td></tr></tbody></table></li><li><p>特殊字符</p><table tabindex="0"><thead><tr><th>字符</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>*</code></td><td>所有值</td><td><code>* * * * *</code>每分钟</td></tr><tr><td><code>,</code></td><td>指定多个值</td><td><code>0,30 * * * *</code>每小时的0分和30分</td></tr><tr><td><code>-</code></td><td>范围</td><td><code>0 9-18 * * *</code>9点到18点每小时</td></tr><tr><td><code>/</code></td><td>间隔</td><td><code>*/5 * * * *</code>每5分钟</td></tr><tr><td><code>H</code></td><td>哈希值（Jenkins特有）</td><td><code>H * * * *</code>每小时内的随机时间</td></tr></tbody></table></li><li><p>常用示例</p><ul><li><p>基本定时</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每天凌晨2点执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每5分钟执行一次</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 工作日的9点到18点每小时执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 9-18</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1-5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每周日凌晨1点执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每月1号凌晨0点执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span></span></code></pre></div></li><li><p>使用H字符（推荐）</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每天随机时间执行一次</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> H</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每天凌晨2点到3点之间的随机时间</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">H</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每小时的随机分钟执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">H</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 工作日的9点到18点每小时随机执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 9-18</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1-5</span></span></code></pre></div></li><li><p>复杂场景</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每30分钟执行一次</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">H/30</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每天10:30和22:30执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10,22</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每月的1号和15号凌晨2点执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1,15</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每周一到周五的9:00、12:00、18:00执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 9,12,18</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1-5</span></span></code></pre></div></li></ul></li><li><p>H字符的优势</p><p><code>H</code>字符是Jenkins的特有功能，用于在大型系统中分散负载：</p><ul><li><p><strong>避免集中执行</strong>：多个任务不会在同一时间点触发</p></li><li><p><strong>提高性能</strong>：避免服务器在整点时刻负载过高</p></li><li><p><strong>随机分布</strong>：在指定时间范围内随机选择执行时间</p></li></ul></li></ol></li><li><p>写一个每两分钟触发构建的cron表达式验证</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>H/2 * * * *</span></span></code></pre></div><p><img src="`+x+'" alt="" data-fancybox="gallery"></p></li><li><p>构建结果</p><p><img src="'+A+'" alt="" data-fancybox="gallery"></p></li></ol><h3 id="_2-3-4-定时检查代码" tabindex="-1">2.3.4 定时检查代码 <a class="header-anchor" href="#_2-3-4-定时检查代码" aria-label="Permalink to &quot;2.3.4 定时检查代码&quot;">​</a></h3><p>就是每隔一段时间检查一次代码是否发生改变，如果改变进行构建</p><ol><li><p>输入表达式</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>H/2 * * * *</span></span></code></pre></div><p><img src="'+j+`" alt="" data-fancybox="gallery"></p></li><li><p>修改代码</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HelloController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RequestMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hello</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hello World！！ 定时检查&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>构建结果</p><p><img src="`+D+'" alt="" data-fancybox="gallery"></p></li></ol><h2 id="_2-4-邮件通知" tabindex="-1">2.4 邮件通知 <a class="header-anchor" href="#_2-4-邮件通知" aria-label="Permalink to &quot;2.4 邮件通知&quot;">​</a></h2><ol><li><p>开通163邮箱的 POP3/SMTP 服务</p><p><img src="'+f+'" alt="" data-fancybox="gallery"></p></li><li><p>设置管理员邮箱（用于发邮件）</p><p><img src="'+q+'" alt="" data-fancybox="gallery"></p></li><li><p>添加邮箱配置(构建触发的邮箱)</p><ul><li><p>选择添加凭证</p><p><img src="'+H+'" alt="" data-fancybox="gallery"></p></li><li><p>凭证填写邮箱与密码</p><p><img src="'+S+'" alt="" data-fancybox="gallery"></p></li><li><p>添加后的凭证</p><p><img src="'+J+'" alt="" data-fancybox="gallery"></p></li><li><p>选择需要的事件触发器</p><p><img src="'+P+'" alt="" data-fancybox="gallery"></p></li></ul></li><li><p>邮件通知(系统级错误才会发送)</p><ul><li><p>配置项</p><p><img src="'+T+'" alt="" data-fancybox="gallery"></p></li><li><p>测试短信</p><p><img src="'+w+'" alt="" data-fancybox="gallery"></p></li><li><p>测试结果</p><p><img src="'+N+'" alt="" data-fancybox="gallery"></p></li></ul></li><li><p>项目- 构建后操作 - 添加邮箱发送用户</p><ul><li><p>选择添加邮箱</p><p><img src="'+$+'" alt="" data-fancybox="gallery"></p></li><li><p>高级设置</p><p><img src="'+G+'" alt="" data-fancybox="gallery"></p></li><li><p>添加构建者用户（就是初始注册用户下邮箱）</p><p><img src="'+R+'" alt="" data-fancybox="gallery"></p></li></ul></li><li><p>验证</p><ul><li><p>构建项目</p><p><img src="'+O+'" alt="" data-fancybox="gallery"></p></li><li><p>邮箱中的邮件</p><p><img src="'+I+'" alt="" data-fancybox="gallery"></p></li></ul></li></ol>',17)]))}const Y=n(M,[["render",W]]);export{Q as __pageData,Y as default};

import{_ as i,c as a,o as n,a0 as l}from"./chunks/framework.zS86-xgI.js";const t="/note-operator/other/install/jenkins/001.png",p="/note-operator/other/install/jenkins/002.png",h="/note-operator/other/install/jenkins/003.png",e="/note-operator/other/install/jenkins/004.png",k="/note-operator/other/install/jenkins/005.png",r="/note-operator/other/install/jenkins/006.png",o="/note-operator/other/install/jenkins/007.png",d="/note-operator/other/install/jenkins/008.png",g="/note-operator/other/install/jenkins/009.png",c="/note-operator/other/install/jenkins/012.png",F="/note-operator/other/install/jenkins/010.png",y="/note-operator/other/install/jenkins/011.png",E="/note-operator/other/install/jenkins/021.png",C="/note-operator/other/install/jenkins/014.png",u="/note-operator/other/install/jenkins/015.png",b="/note-operator/other/install/jenkins/013.png",B="/note-operator/other/install/jenkins/016.png",m="/note-operator/other/install/jenkins/017.png",_="/note-operator/other/install/jenkins/018.png",v="/note-operator/other/install/jenkins/019.png",D="/note-operator/other/install/jenkins/020.png",A="/note-operator/other/install/jenkins/032.png",j="/note-operator/other/install/jenkins/023.png",x="/note-operator/other/install/jenkins/024.png",f="/note-operator/other/install/jenkins/025.png",q="/note-operator/other/install/jenkins/026.png",P="/note-operator/other/install/jenkins/027.png",S="/note-operator/other/install/jenkins/028.png",w="/note-operator/other/install/jenkins/029.png",T="/note-operator/other/install/jenkins/030.png",O="/note-operator/other/install/jenkins/031.png",R="/note-operator/other/install/jenkins/033.png",I="/note-operator/other/install/jenkins/034.png",J="/note-operator/other/install/jenkins/035.png",H="/note-operator/other/install/jenkins/036.png",N="/note-operator/other/install/jenkins/039.png",$="/note-operator/other/install/jenkins/037.png",G="/note-operator/other/install/jenkins/038.png",L="/note-operator/other/install/jenkins/040.png",K="/note-operator/other/install/jenkins/041.png",X="/note-operator/other/install/jenkins/042.png",Y="/note-operator/other/install/jenkins/045.png",M="/note-operator/other/install/jenkins/044.png",z="/note-operator/other/install/jenkins/043.png",W="/note-operator/other/install/jenkins/046.png",U="/note-operator/other/install/jenkins/047.png",V="/note-operator/other/install/jenkins/048.png",Q="/note-operator/other/install/jenkins/049.png",Z="/note-operator/other/install/jenkins/050.png",ss="/note-operator/other/install/jenkins/051.png",is="/note-operator/other/install/jenkins/052.png",as="/note-operator/other/install/jenkins/053.png",ns="/note-operator/other/install/jenkins/054.png",ls="/note-operator/other/install/jenkins/055.png",ts="/note-operator/other/install/jenkins/058.png",ps="/note-operator/other/install/jenkins/057.png",hs="/note-operator/other/install/jenkins/056.png",es="/note-operator/other/install/jenkins/059.png",ks="/note-operator/other/install/jenkins/060.png",rs="/note-operator/other/install/jenkins/061.png",os="/note-operator/other/install/jenkins/062.png",ds="/note-operator/other/install/jenkins/063.png",gs="/note-operator/other/install/jenkins/064.png",ms=JSON.parse('{"title":"一、jenkins部署安装","description":"","frontmatter":{},"headers":[],"relativePath":"markdown/other/install/Jenkins/01.md","filePath":"markdown/other/install/Jenkins/01.md"}'),cs={name:"markdown/other/install/Jenkins/01.md"};function Fs(ys,s,Es,Cs,us,bs){return n(),a("div",null,s[0]||(s[0]=[l('<h1 id="一、jenkins部署安装" tabindex="-1">一、jenkins部署安装 <a class="header-anchor" href="#一、jenkins部署安装" aria-label="Permalink to &quot;一、jenkins部署安装&quot;">​</a></h1><p><strong>Jenkins</strong> 是一个开源的自动化服务器，用于实现持续集成和持续交付（CI/CD），帮助团队自动化软件构建、测试和部署过程。</p><h2 id="_1-1-了解与准备" tabindex="-1">1.1 了解与准备 <a class="header-anchor" href="#_1-1-了解与准备" aria-label="Permalink to &quot;1.1 了解与准备&quot;">​</a></h2><ol><li><p>jenkins在开发过程中所属位置</p><p><img src="'+t+`" alt="" data-fancybox="gallery"></p></li><li><p>准备服务器</p><ul><li><strong>Jenkins-GitLab</strong>：系统<code>Rocky Linux9</code>,内存6G,CPU2核,磁盘20G,IP<code>192.168.18.81</code></li><li><strong>Jenkins-Server</strong>：系统<code>Rocky Linux9</code>,内存2G,CPU2核,磁盘20G,IP<code>192.168.18.82</code></li><li><strong>Jenkins-Test</strong>：系统<code>Rocky Linux9</code>,内存4G,CPU4核,磁盘10G,IP<code>192.168.18.83</code></li><li><strong>Jenkins-Docker</strong>：系统<code>Rocky Linux9</code>,内存6G,CPU2核,磁盘20G,IP<code>192.168.18.84</code></li></ul></li></ol><h2 id="_1-2-gitlab的安装使用" tabindex="-1">1.2 GitLab的安装使用 <a class="header-anchor" href="#_1-2-gitlab的安装使用" aria-label="Permalink to &quot;1.2 GitLab的安装使用&quot;">​</a></h2><h3 id="_1-2-1-gitlab介绍及安装准备" tabindex="-1">1.2.1 GitLab介绍及安装准备 <a class="header-anchor" href="#_1-2-1-gitlab介绍及安装准备" aria-label="Permalink to &quot;1.2.1 GitLab介绍及安装准备&quot;">​</a></h3><p>GitLab 是一个完整的 DevOps 平台，从项目计划、源代码管理到 CI/CD、监控，全部在一个应用中完成。​ 它不只是 Git 仓库，而是一体化的软件开发平台。</p><p>官方网站: <a href="https://about.gitlab.com/" target="_blank" rel="noreferrer">https://about.gitlab.com/</a> 中文配置需求：<a href="https://docs.gitlab.cn/docs/omnibus/installation/" target="_blank" rel="noreferrer">https://docs.gitlab.cn/docs/omnibus/installation/</a></p><blockquote><p>这里只需要它的代码集成功能（也就是免费版本）</p></blockquote><h3 id="_1-2-2-shh下安装" tabindex="-1">1.2.2 SHH下安装 <a class="header-anchor" href="#_1-2-2-shh下安装" aria-label="Permalink to &quot;1.2.2 SHH下安装&quot;">​</a></h3><p>官方安装文档: <a href="https://docs.gitlab.com/install/package" target="_blank" rel="noreferrer">https://docs.gitlab.com/install/package</a></p><ol><li><p>安装依赖</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> policycoreutils-python-utils</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openssh-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sshd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sshd</span></span></code></pre></div></li><li><p>配置镜像</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 添加 GitLab 官方仓库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 清华镜像源配置（官方仓库200kb/s,配置完成按照你的最大网络）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/yum.repos.d/gitlab-ce.repo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[gitlab-ce]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">name=GitLab CE Repository</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">baseurl=https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el$releasever/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gpgcheck=0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">enabled=1</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre></div></li><li><p>开始安装</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> EXTERNAL_URL=&quot;http://192.168.18.81&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitlab-ce</span></span></code></pre></div></li><li><p>安装结果</p><p><img src="`+p+'" alt="" data-fancybox="gallery"></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/gitlab/initial_root_password</span></span></code></pre></div><blockquote><p>注意：除非您在安装过程中指定了自定义密码，否则将随机生成一个密码并存储在<code>/etc/gitlab/initial_root_password</code> 文件中(出于安全原因，24小时后，此文件会被第一次 <code>gitlab-ctlreconfigure</code> 自动删除，因此若使用随机密码登录，建议安装成功初始登录成功之后，立即修改初始密码)。使用此密码和用户名 root 登录。</p></blockquote><p><img src="'+h+'" alt="" data-fancybox="gallery"></p></li><li><p>gitlab设置中文</p><ul><li>‌<strong>登录后进入偏好设置‌</strong>‌：使用账户登录 GitLab，点击页面右上角的个人头像，选择“Settings”或“Preferences”（偏好设置）。‌</li><li>‌<strong>修改语言选项‌</strong>‌：在设置页面中，找到“Localization”（本地化）或类似区域，将语言从默认“English”更改为“简体中文”。‌</li><li>‌<strong>保存并刷新页面‌</strong>‌：完成修改后，点击“Save changes”或相应保存按钮。随后刷新浏览器页面，界面即显示为中文。 若未立即生效，可尝试退出账户重新登录。‌</li></ul><p><img src="'+e+`" alt="" data-fancybox="gallery"></p></li></ol><h3 id="_1-2-3-docker下安装" tabindex="-1">1.2.3 Docker下安装 <a class="header-anchor" href="#_1-2-3-docker下安装" aria-label="Permalink to &quot;1.2.3 Docker下安装&quot;">​</a></h3><ol><li><p>yum处理</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 更新yum</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装docker工具环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum-utils</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> device-mapper-persistent-data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lvm2</span></span></code></pre></div></li><li><p>安装docker</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看源中可使用版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">list</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-ce</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --showduplicates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装指定版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 配置开机启动项</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span></span></code></pre></div></li><li><p>安装gitlab</p><p>gitlab再docker上的地址：<a href="https://hub.docker.com/r/gitlab/gitlab-ce" target="_blank" rel="noreferrer">https://hub.docker.com/r/gitlab/gitlab-ce</a></p><ol><li><p>添加并运行GitLab容器</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --detach</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --hostname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.18.84</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --publish</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5000:80</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitlab</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> always</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /srv/gitlab/config:/etc/gitlab:z</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /srv/gitlab/logs:/var/log/gitlab:z</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /srv/gitlab/data:/var/opt/gitlab:z</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --shm-size</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 256m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  gitlab/gitlab-ce:latest</span></span></code></pre></div><p><strong>中途失败或者已下载文件</strong></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 移除容器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 914385c4d1fa</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重新启动</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitlab</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5000:80</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitlab/gitlab-ce:latest</span></span></code></pre></div></li><li><p>容器操作</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动容器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitlab</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看容器装填</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span></span></code></pre></div></li><li><p>寻找密码文件</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入容器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitlab</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/bash</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/gitlab/initial_root_password</span></span></code></pre></div></li></ol></li><li><p>外部登录</p><p><img src="`+k+'" alt="" data-fancybox="gallery"></p></li></ol><h3 id="_1-2-4-gitlab客户端提交代码" tabindex="-1">1.2.4 gitlab客户端提交代码 <a class="header-anchor" href="#_1-2-4-gitlab客户端提交代码" aria-label="Permalink to &quot;1.2.4 gitlab客户端提交代码&quot;">​</a></h3><ol><li><p>创建项目</p><p><img src="'+r+'" alt="" data-fancybox="gallery"></p><p><img src="'+o+'" alt="" data-fancybox="gallery"></p><p><img src="'+d+'" alt="" data-fancybox="gallery"></p><p><img src="'+g+'" alt="" data-fancybox="gallery"></p></li><li><p>配置SSH密钥</p><p><img src="'+c+`" alt="" data-fancybox="gallery"></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 git 获取SSH密钥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh-keygen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rsa</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GitHub账号邮箱</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .ssh/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id_rsa.pub</span></span></code></pre></div></li><li><p>idea创建项目</p><ul><li><p>项目配置</p><p><img src="`+F+'" alt="" data-fancybox="gallery"></p><p><img src="'+y+`" alt="" data-fancybox="gallery"></p></li><li><p>主要代码</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Controller</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ResponseBody</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HelloController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RequestMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hello</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>运行结果</p><p><img src="`+E+'" alt="" data-fancybox="gallery"></p></li></ul></li><li><p>提交代码</p><ul><li><p>安装插件</p><p><img src="'+C+'" alt="" data-fancybox="gallery"></p></li><li><p>添加个人访问令牌</p><p><img src="'+u+'" alt="" data-fancybox="gallery"></p></li><li><p>提交命令</p><p><img src="'+b+'" alt="" data-fancybox="gallery"></p></li></ul></li><li><p>合并分支</p><ul><li><p>进入项目中 可以看到两个分支</p><p><img src="'+B+'" alt="" data-fancybox="gallery"></p></li><li><p>创建合并分支请求</p><p><img src="'+m+'" alt="" data-fancybox="gallery"></p></li><li><p>一些指标</p><p><img src="'+_+'" alt="" data-fancybox="gallery"></p></li><li><p>选择立即合并</p><p><img src="'+v+'" alt="" data-fancybox="gallery"></p></li><li><p>合并结果</p><p><img src="'+D+`" alt="" data-fancybox="gallery"></p></li></ul></li></ol><h2 id="_1-3-jenkins安装使用" tabindex="-1">1.3 jenkins安装使用 <a class="header-anchor" href="#_1-3-jenkins安装使用" aria-label="Permalink to &quot;1.3 jenkins安装使用&quot;">​</a></h2><h3 id="_1-3-1-安装jdk" tabindex="-1">1.3.1 安装jdk <a class="header-anchor" href="#_1-3-1-安装jdk" aria-label="Permalink to &quot;1.3.1 安装jdk&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#  搜索可用的 JDK 包</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> search</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jdk</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 JDK 开发包</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java-1.17.0-openjdk-devel</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 验证安装</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -version</span></span></code></pre></div><h3 id="_1-3-2-安装maven" tabindex="-1">1.3.2 安装maven <a class="header-anchor" href="#_1-3-2-安装maven" aria-label="Permalink to &quot;1.3.2 安装maven&quot;">​</a></h3><ol><li><p>寻找maven下载地址 <a href="https://maven.apache.org/download.cgi" target="_blank" rel="noreferrer">https://maven.apache.org/download.cgi</a></p><p><img src="`+A+`" alt="" data-fancybox="gallery"></p><p>复制链接或者直接下载</p></li><li><p>开始安装</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 下载最新版Maven</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://dlcdn.apache.org/maven/maven-3/3.9.11/binaries/apache-maven-3.9.11-bin.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 解压到/opt目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -zxvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache-maven-3.9.11-bin.tar.gz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 修改文件夹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/apache-maven-3.9.11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/maven</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 配置环境变量</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;export M2_HOME=/opt/maven&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.bashrc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;export PATH=$M2_HOME/bin:$PATH&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.bashrc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. 使配置生效</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.bashrc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 6. 验证安装</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mvn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -version</span></span></code></pre></div><blockquote><p>不用dnf安装主要是要修改下载代理</p></blockquote></li><li><p>修改代理镜像</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入maven配置文件夹中</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/maven/config</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 备份文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> settings.xml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> settings.xml.bak</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 新建配置</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> settings.xml</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试代理是否生效</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mvn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> help:effective-settings</span></span></code></pre></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;?</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">xml</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UTF-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">settings</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	xmlns:xsi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	xsi:schemaLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/		xsd/settings-1.0.0.xsd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	&lt;!-- 阿里云镜像 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mirrors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mirror</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;aliyunmaven&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mirrorOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;*&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mirrorOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;阿里云公共仓库&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;https://maven.aliyun.com/repository/public&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mirror</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mirrors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	&lt;!-- 文件位置 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">localRepository</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;/opt/maven/MavenRepository&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">localRepository</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">settings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li></ol><h3 id="_1-3-3-安装git" tabindex="-1">1.3.3 安装git <a class="header-anchor" href="#_1-3-3-安装git" aria-label="Permalink to &quot;1.3.3 安装git&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 添加EPEL仓库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> epel-release</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装最新版Git</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 验证git</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --version</span></span></code></pre></div><h3 id="_1-3-4-jenkins-下载安装" tabindex="-1">1.3.4 jenkins 下载安装 <a class="header-anchor" href="#_1-3-4-jenkins-下载安装" aria-label="Permalink to &quot;1.3.4 jenkins 下载安装&quot;">​</a></h3><ol><li><p>进入官网</p><ul><li>jenkins官网: <a href="https://www.jenkins.io/" target="_blank" rel="noreferrer">https://www.jenkins.io/</a></li><li>jenkins官网中文(更舒服): <a href="https://www.jenkins.io/zh/" target="_blank" rel="noreferrer">https://www.jenkins.io/zh/</a></li></ul></li><li><p>下载上传</p><p>下载地址:<a href="https://www.jenkins.io/download/" target="_blank" rel="noreferrer">https://www.jenkins.io/download/</a></p><p>上传文件的位置 /opt/jenkins/jenkins.war</p></li><li><p>启动 jenkins.war 文件 测试</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jenkins.war</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --httpPort=8080</span></span></code></pre></div><p><strong>初始化密码</strong></p><p><img src="`+j+`" alt="" data-fancybox="gallery"></p></li><li><p>启动脚本</p><ol><li><p>准备工作（为了下载插件）</p><ul><li>安装 shadowsocks-rust 客户端</li><li>安装 privoxy 网络代理</li><li>使用 <code>curl -I --proxy http://127.0.0.1:8118 http://www.google.com</code> 测试</li><li>具体可查看 <a href="/note-operator/markdown/network/external/shadowsocks/02.html#_1-3-安装linux-shadowsocks-rust">安装linux (shadowsocks-rust)</a></li></ul></li><li><p>新建脚本</p><ol><li><p>后台脚本，用于手动启动</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 新建脚本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/jenkins/start-jenkins.sh</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改脚本权限</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chomd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 755</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/jenkins/start-jenkins.sh</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动脚本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/jenkins/start-jenkins.sh</span></span></code></pre></div></li><li><p>start-jenkins启动脚本</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">JENKINS_WAR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/opt/jenkins/jenkins.war&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HTTP_PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">JAVA_OPTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-Djava.awt.headless=true -Xmx1024m&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">JENKINS_LOG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/opt/jenkins/jenkins.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">JENKINS_PID_FILE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/opt/jenkins/jenkins.pid&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 代理设置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PROXY_HOST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;127.0.0.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PROXY_PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8118&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动Jenkins</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;正在启动Jenkins...&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	nohup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $JAVA_OPTS </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		-Dhttp.proxyHost=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_HOST</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		-Dhttp.proxyPort=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_PORT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		-Dhttps.proxyHost=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_HOST</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		-Dhttps.proxyPort=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_PORT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		-jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$JENKINS_WAR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		--httpPort=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HTTP_PORT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $JENKINS_LOG </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">2&gt;&amp;1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	JENKINS_PID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $JENKINS_PID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $JENKINS_PID_FILE</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Jenkins已启动，PID: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$JENKINS_PID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 停止Jenkins</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;正在停止Jenkins...&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $JENKINS_PID_FILE ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		PID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $JENKINS_PID_FILE)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		kill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $PID</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $JENKINS_PID_FILE</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Jenkins已停止&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Jenkins未运行&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	fi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 主逻辑</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">	start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		start</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		;;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">	stop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		stop</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		;;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	*)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">esac</span></span></code></pre></div></li></ol></li><li><p>前台脚本</p><ul><li><p>新建脚本</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 新建脚本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/jenkins/system-jenkins.sh</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改脚本权限</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chomd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 755</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/jenkins/system-jenkins.sh</span></span></code></pre></div></li><li><p>脚本内容</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">JENKINS_WAR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/opt/jenkins/jenkins.war&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HTTP_PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">8080</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">JAVA_OPTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-Djava.awt.headless=true -Xmx1024m&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 代理设置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PROXY_HOST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;127.0.0.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PROXY_PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8118&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;正在启动Jenkins...&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Jenkins日志: /opt/jenkins/jenkins.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;HTTP端口: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HTTP_PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;代理: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_HOST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 删除旧日志</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /opt/jenkins/jenkins.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 前台运行（不要用nohup和&amp;）</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $JAVA_OPTS </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -Dhttp.proxyHost=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_HOST</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -Dhttp.proxyPort=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_PORT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -Dhttps.proxyHost=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_HOST</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -Dhttps.proxyPort=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROXY_PORT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$JENKINS_WAR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --httpPort=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HTTP_PORT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/jenkins/jenkins.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 2&gt;&amp;1</span></span></code></pre></div></li><li><p>加入开机自启</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建启动文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/jenkins.service</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重新加载systemd配置</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置开机自启并启动服务与检查状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jenkins</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jenkins</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jenkins</span></span></code></pre></div><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=Jenkins CI Server</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">After</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=network.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=simple</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=root</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ExecStart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/opt/jenkins/system-jenkins.sh</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=always</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestartSec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=10</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WantedBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=multi-user.target</span></span></code></pre></div></li><li><p>如果和我一样使用rocky Linux 会遇到 SELinux 问题</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setenforce</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chcon</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bin_t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/jenkins/start-jenkins.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setenforce</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jenkins.service</span></span></code></pre></div></li></ul></li></ol></li><li><p>jenkins的初始配置</p><ul><li><p>输入密码</p><p><img src="`+x+'" alt="" data-fancybox="gallery"></p></li><li><p>选择推荐插件</p><p><img src="'+f+'" alt="" data-fancybox="gallery"></p></li><li><p>自己可能会用到的</p><ul><li><code>OWASP Markup Formatter</code>: HTML文本标记(jenkins自带功能之一)</li><li><code>Build Timeout</code>: 构建超时控制,防止卡死构建占用资源</li><li><code>Credentials Binding</code>: 凭据绑定到环境变量</li><li><code>SSH Agent</code> SSH代理，部署到其他服务器</li><li><code>Workspace Cleanup</code>: 构建前后清理磁盘空间</li><li><code>NodeJS</code>: 打包前端包必备</li><li><code>Junit</code>: 收集和展示单元测试结果</li><li><code>Pipeline</code>: 定义CI/CD流水线，支持脚本式和声明式流水线</li><li><code>Pipeline Graph View</code>: 流水线作业图，展示哪些步骤出错</li><li><code>Git</code>: 从Git仓库拉取代码，支持GitHub、GitLab、Bitbucket等</li><li><code>GitLab</code>: Webhook自动触发构建、PR检查等</li><li><code>Subversion</code>: svn构建</li><li><code>Email Extension</code> 电子邮件扩展</li><li><code>Localization: Chinese (Simplified)</code>: 中文语言包（必装）</li></ul></li><li><p>安装中</p><p><img src="'+q+'" alt="" data-fancybox="gallery"></p></li><li><p>输入账户密码与邮箱</p><p><img src="'+P+'" alt="" data-fancybox="gallery"></p></li><li><p>实例配置（默认就可以）</p><p><img src="'+S+'" alt="" data-fancybox="gallery"></p></li><li><p>登录jenkins</p><p><img src="'+w+'" alt="" data-fancybox="gallery"></p></li><li><p>进入插件中</p><p><img src="'+T+'" alt="" data-fancybox="gallery"></p><p><img src="'+O+'" alt="" data-fancybox="gallery"></p></li></ul></li></ol><h3 id="_1-3-5-配置maven-git自动构建jar包" tabindex="-1">1.3.5 配置Maven+Git自动构建jar包 <a class="header-anchor" href="#_1-3-5-配置maven-git自动构建jar包" aria-label="Permalink to &quot;1.3.5 配置Maven+Git自动构建jar包&quot;">​</a></h3><ol><li><p>安装maven插件</p><p><img src="'+R+'" alt="" data-fancybox="gallery"></p><p><img src="'+I+'" alt="" data-fancybox="gallery"></p><p><img src="'+J+'" alt="" data-fancybox="gallery"></p></li><li><p>配置maven</p><p><img src="'+H+'" alt="" data-fancybox="gallery"></p><p><img src="'+N+'" alt="" data-fancybox="gallery"></p></li><li><p>拉取项目</p><ul><li><p>新建item</p><p><img src="'+$+'" alt="" data-fancybox="gallery"></p><p><img src="'+G+'" alt="" data-fancybox="gallery"></p></li><li><p>git配置</p><p><img src="'+L+'" alt="" data-fancybox="gallery"></p></li></ul></li><li><p>构建项目</p><ul><li><p><strong>启动构建</strong></p><p><img src="'+K+'" alt="" data-fancybox="gallery"></p></li><li><p><strong>构建成功</strong></p><p><img src="'+X+'" alt="" data-fancybox="gallery"></p></li><li><p><strong>控制台输出</strong></p><p><img src="'+Y+'" alt="" data-fancybox="gallery"></p><p><img src="'+M+'" alt="" data-fancybox="gallery"></p><p>构建成功以及jar包的位置</p><p><img src="'+z+`" alt="" data-fancybox="gallery"></p></li></ul></li></ol><h2 id="_1-4-自动化发布到测试服务器并自动运行" tabindex="-1">1.4 自动化发布到测试服务器并自动运行 <a class="header-anchor" href="#_1-4-自动化发布到测试服务器并自动运行" aria-label="Permalink to &quot;1.4 自动化发布到测试服务器并自动运行&quot;">​</a></h2><h3 id="_1-4-1-测试服务器安装jre" tabindex="-1">1.4.1 测试服务器安装jre <a class="header-anchor" href="#_1-4-1-测试服务器安装jre" aria-label="Permalink to &quot;1.4.1 测试服务器安装jre&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#  搜索可用的 JDK 包</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> search</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jdk</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 JDK 开发包</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java-17-openjdk.x86_64</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 验证安装</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -version</span></span></code></pre></div><h3 id="_1-4-2-jenkins-安装-publish-over-ssh" tabindex="-1">1.4.2 jenkins 安装 <code>Publish Over SSH</code> <a class="header-anchor" href="#_1-4-2-jenkins-安装-publish-over-ssh" aria-label="Permalink to &quot;1.4.2 jenkins 安装 \`Publish Over SSH\`&quot;">​</a></h3><ol><li><p>搜索插件</p><p><img src="`+W+'" alt="" data-fancybox="gallery"></p></li><li><p>等待安装</p><p><img src="'+U+'" alt="" data-fancybox="gallery"></p></li><li><p>安装完成</p><p><img src="'+V+'" alt="" data-fancybox="gallery"></p></li></ol><h3 id="_1-4-3-jenkins-配置服务器" tabindex="-1">1.4.3 jenkins 配置服务器 <a class="header-anchor" href="#_1-4-3-jenkins-配置服务器" aria-label="Permalink to &quot;1.4.3 jenkins 配置服务器&quot;">​</a></h3><ol><li><p>选择系统配置</p><p><img src="'+Q+'" alt="" data-fancybox="gallery"></p></li><li><p>新增SHH服务器</p><p><img src="'+Z+'" alt="" data-fancybox="gallery"></p></li><li><p>配置用户与密码</p><p><img src="'+ss+'" alt="" data-fancybox="gallery"></p></li></ol><h3 id="_1-4-4-构建中后将文件传给测试服务器" tabindex="-1">1.4.4 构建中后将文件传给测试服务器 <a class="header-anchor" href="#_1-4-4-构建中后将文件传给测试服务器" aria-label="Permalink to &quot;1.4.4 构建中后将文件传给测试服务器&quot;">​</a></h3><ol><li><p>进入项目配置</p><p><img src="'+is+'" alt="" data-fancybox="gallery"></p></li><li><p>选择 <code>Send files or execute commands over SSH</code></p><p><img src="'+as+'" alt="" data-fancybox="gallery"></p></li><li><p>确认jar包位置</p><p><img src="'+ns+'" alt="" data-fancybox="gallery"></p></li><li><p>最基础的传递文件</p><p><img src="'+ls+'" alt="" data-fancybox="gallery"></p></li><li><p>重新构建</p><ul><li><p>开始构建</p><p><img src="'+ts+'" alt="" data-fancybox="gallery"></p></li><li><p>构建结果</p><p><img src="'+ps+'" alt="" data-fancybox="gallery"></p></li><li><p>从服务器查找构建的文件</p><p><img src="'+hs+'" alt="" data-fancybox="gallery"></p></li></ul></li><li><p>启动jar包验证结果</p><p><img src="'+es+'" alt="" data-fancybox="gallery"></p></li></ol><h3 id="_1-4-5-构建配置优化" tabindex="-1">1.4.5 构建配置优化 <a class="header-anchor" href="#_1-4-5-构建配置优化" aria-label="Permalink to &quot;1.4.5 构建配置优化&quot;">​</a></h3><ol><li><p>构建配置-传递文件</p><p><img src="'+ks+'" alt="" data-fancybox="gallery"></p></li><li><p>重新构建项目</p><p><img src="'+rs+'" alt="" data-fancybox="gallery"></p></li><li><p>控制台显示（显示已超时，后续会改的）</p><p><img src="'+os+'" alt="" data-fancybox="gallery"></p></li><li><p>查看进程</p><p><img src="'+ds+`" alt="" data-fancybox="gallery"></p></li><li><p>开放防火墙端口</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 永久开放8080端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --add-port=8080/tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使永久规则生效</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reload</span></span></code></pre></div></li><li><p>页面运行效果</p><p><img src="`+gs+'" alt="" data-fancybox="gallery"></p></li></ol>',38)]))}const _s=i(cs,[["render",Fs]]);export{ms as __pageData,_s as default};

# 一、安装 Nginx

## 1.1 Linux 安装

### 1.1.1 远程下载源码编译安装（适用于需要自定义模块或最新版本）

**适用场景**：需定制功能、使用最新特性、或系统无包管理器。

**步骤**：

```bash
# 1. 安装编译依赖
# Ubuntu/Debian
sudo apt update && sudo apt install build-essential libpcre3 libpcre3-dev zlib1g-dev libssl-dev -y

# CentOS/Rocky/Alma
sudo yum groupinstall "Development Tools" -y
sudo yum install pcre-devel zlib-devel openssl-devel -y

# 2. 下载 Nginx 源码（以 1.28.2 为例）
wget https://nginx.org/download/nginx-1.28.2.tar.gz
tar -zxvf nginx-1.28.2.tar.gz
cd nginx-1.28.2

# 3 编译位置
./configure \
  --prefix=/usr/local/nginx

# 或者 配置编译选项（常用）
./configure \
  --prefix=/usr/local/nginx \
  --sbin-path=/usr/local/nginx/sbin/nginx \
  --conf-path=/usr/local/nginx/conf/nginx.conf \
  --error-log-path=/var/log/nginx/error.log \
  --http-log-path=/var/log/nginx/access.log \
  --pid-path=/var/run/nginx.pid \
  --with-http_ssl_module \
  --with-http_v2_module \
  --with-http_realip_module \
  --with-http_stub_status_module


# 4. 编译并安装
make && sudo make install

# 5. 启动（可创建 systemd 服务）
sudo /usr/local/nginx/sbin/nginx
```

> 优点：完全控制；缺点：无自动更新，需手动管理服务。

### 1.1.2 使用 yum/apt 包管理器安装（推荐生产环境使用）

**Ubuntu/Debian**：
```bash
sudo apt update
sudo apt install nginx -y
sudo systemctl enable --now nginx
```

**CentOS/Rocky/Alma (使用 EPEL)**：
```bash
# CentOS 7
sudo yum install epel-release -y && sudo yum install nginx -y

# CentOS 8+/Rocky/Alma
sudo dnf install epel-release -y && sudo dnf install nginx -y

sudo systemctl enable --now nginx
```

> 优点：简单、安全、自动集成 systemd、支持 `apt upgrade` / `dnf update` 升级。

## 1.2 Windows 安装

**注意**：Nginx 官方提供 Windows 版本，但 **仅用于开发测试，不推荐用于生产环境**。

**步骤**：

1. 访问 [https://nginx.org/en/download.html](https://nginx.org/en/download.html)
2. 下载 **Windows 版本**（如 `nginx/Windows-1.25.5`）
3. 解压到目录（如 `C:\nginx`）
4. 以管理员身份打开 CMD 或 PowerShell：
   ```cmd
   cd C:\nginx
   start nginx.exe
   ```
5. 验证：访问 `http://localhost`，看到欢迎页即成功。

**常用命令**：
```cmd
nginx.exe -s stop        # 停止
nginx.exe -s quit        # 优雅退出
nginx.exe -s reload      # 重载配置
nginx.exe -t             # 测试配置
```

> 注意：Windows 版不支持部分 Unix 特性（如 `fork`），性能和稳定性不如 Linux。


## 1.3 Docker 安装

**适用场景**：快速部署、微服务、容器化环境。

### 方式一：直接运行官方镜像

```bash
# 拉取并运行（前台模式）
docker run --name my-nginx -p 80:80 -d nginx

# 挂载自定义配置和静态文件
docker run --name my-nginx \
  -v ./nginx.conf:/etc/nginx/nginx.conf:ro \
  -v ./html:/usr/share/nginx/html:ro \
  -p 80:80 \
  -d nginx
```

### 方式二：使用 Docker Compose（推荐）

创建 `docker-compose.yml`：
```yaml
version: '3'
services:
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./conf.d:/etc/nginx/conf.d
      - ./html:/usr/share/nginx/html
      - ./logs:/var/log/nginx
    restart: unless-stopped
```

启动：
```bash
docker-compose up -d
```

> 优点：环境隔离、一键部署、易于扩展；  
> 提示：生产环境建议使用 `nginx:stable-alpine` 镜像以减小体积。


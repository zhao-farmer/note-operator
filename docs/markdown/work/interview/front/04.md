# 四、CSS


## 4.1 选择器与优先级

### 1. CSS 选择器的优先级计算规则是什么？

**回答**：CSS优先级从高到低：

1.  `!important`
    
2.  内联样式 (1000)
    
3.  ID选择器 (100)
    
4.  类/伪类/属性选择器 (10)
    
5.  元素/伪元素选择器 (1)
    
6.  通配符/继承 (0)
    

**代码示例**：

```css
/* 计算示例 */
#id .class div { color: blue; }  /* 100+10+1=111 */
.class div { color: red; }        /* 10+1=11 */
div { color: green; }             /* 1 */
```

### 2. 伪类和伪元素的区别是什么？

**回答**：

*   **伪类**：选择元素的特定状态，单冒号 `:`
    
*   **伪元素**：创建虚拟元素，双冒号 `::`（CSS3）
    

**代码示例**：

```css
/* 伪类：元素状态 */
a:hover { color: red; }
li:first-child { font-weight: bold; }

/* 伪元素：创建虚拟元素 */
p::before { content: "→ "; }
p::first-line { color: blue; }
```

### 3. :nth-child() 和 :nth-of-type() 的区别？

**回答**：

*   `:nth-child(n)`：父元素中第n个子元素，不考虑类型
    
*   `:nth-of-type(n)`：父元素中第n个指定类型的子元素
    

**代码示例**：

```plain
html
```

```plain
<div>
  <p>段落1</p>
  <span>span1</span>
  <p>段落2</p>
  <span>span2</span>
</div>
```

```css
p:nth-child(3) { color: red; }    /* 不生效，第3个是p但:nth-child(3)选不到 */
p:nth-of-type(2) { color: blue; } /* 生效，选择第2个p元素 */
```

### 4. 属性选择器有哪些？

**回答**：

*   `[attr]`：拥有该属性
    
*   `[attr=value]`：属性等于value
    
*   `[attr~=value]`：属性包含单词value
    
*   `[attr|=value]`：属性以value开头或value-开头
    
*   `[attr^=value]`：属性以value开头
    
*   `[attr$=value]`：属性以value结尾
    
*   `[attr*=value]`：属性包含value
    

**代码示例**：

```css
input[type="text"] { border: 1px solid #ccc; }
a[href^="https"] { color: green; }
img[alt~="logo"] { width: 100px; }
```

### 5. 相邻兄弟和通用兄弟选择器区别？

**回答**：

*   `+`：相邻兄弟选择器，选择紧邻的下一个兄弟元素
    
*   `~`：通用兄弟选择器，选择后面所有符合条件的兄弟元素
    

**代码示例**：

```plain
html
```

```plain
<div>
  <p>p1</p>
  <span>span1</span>
  <span>span2</span>
  <p>p2</p>
</div>
```

```css
p + span { color: red; }   /* 只选择span1 */
p ~ span { color: blue; }  /* 选择span1和span2 */
```

## 4.2 盒模型与布局

### 1. 标准盒模型和IE盒模型的区别？

**回答**：

*   **标准盒模型**：`width = content宽度`
    
*   **IE盒模型**：`width = content + padding + border`
    

**代码示例**：

```css
.box {
  width: 200px;
  padding: 20px;
  border: 5px solid black;
}
/* 标准盒模型：总宽度=200+40+10=250px */
/* IE盒模型：总宽度=200px，content=150px */
```

### 2. box-sizing 属性值

**回答**：

*   `content-box`：标准盒模型（默认）
    
*   `border-box`：IE盒模型
    
*   `padding-box`：width包含padding（已废弃）
    

**代码示例**：

```css
.box {
  box-sizing: border-box;
  width: 200px;
  padding: 20px; /* 实际content宽度为160px */
}
```

### 3. margin 塌陷及解决方法

**回答**：相邻块级元素的垂直外边距会合并

**代码示例**：

```plain
html
```

```plain
<div class="parent">
  <div class="child1" style="margin-bottom: 50px">Child 1</div>
  <div class="child2" style="margin-top: 30px">Child 2</div>
</div>
```

实际间距为50px（不是80px）

**解决方法**：

```css
/* 1. 使用padding替代 */
.parent { padding: 1px 0; }

/* 2. 创建BFC */
.parent { overflow: hidden; }

/* 3. 使用border */
.parent { border-top: 1px solid transparent; }

/* 4. Flexbox或Grid布局 */
.parent { display: flex; flex-direction: column; }
```

### 4. BFC（块级格式化上下文）

**回答**：独立的渲染区域，内部元素不会影响外部

**创建BFC的方法**：

```css
/* 1. 根元素 */
html

/* 2. float不为none */
.element { float: left; }

/* 3. position为absolute/fixed */
.element { position: absolute; }

/* 4. display为inline-block/table-cell等 */
.element { display: inline-block; }

/* 5. overflow不为visible */
.element { overflow: hidden; }

/* 6. display: flow-root（推荐） */
.element { display: flow-root; }
```

### 5. IFC、GFC、FFC

**回答**：

*   **IFC**：行内格式化上下文，行内元素水平排列
    
*   **GFC**：网格格式化上下文，`display: grid`
    
*   **FFC**：弹性格式化上下文，`display: flex/inline-flex`
    

**代码示例**：

```css
/* IFC */
.inline-container { font-size: 16px; line-height: 1.5; }

/* GFC */
.grid-container { 
  display: grid;
  grid-template-columns: repeat(3, 1fr);
}

/* FFC */
.flex-container {
  display: flex;
  justify-content: space-between;
}
```

## 4.3 定位与浮动

### 1. position 各值特点

**代码示例**：

```css
/* static：默认，正常文档流 */
.element { position: static; }

/* relative：相对自身定位，保留原空间 */
.element { 
  position: relative;
  top: 10px;
  left: 20px;
}

/* absolute：相对最近非static祖先定位 */
.element {
  position: absolute;
  top: 0;
  left: 0;
}

/* fixed：相对视口定位 */
.element {
  position: fixed;
  bottom: 20px;
  right: 20px;
}

/* sticky：滚动时固定 */
.element {
  position: sticky;
  top: 0;
}
```

### 2. 绝对定位的参照物

**回答**：相对于最近的非 `position: static` 的祖先元素，如果没有则相对于初始包含块（通常是html）

**代码示例**：

```plain
html
```

```plain
<div class="relative-parent">
<div class="absolute-child">
</div>
</div>
```

```css
.relative-parent {
  position: relative; /* 作为参照物 */
  width: 400px;
  height: 300px;
}

.absolute-child {
  position: absolute;
  top: 50px;
  left: 50px;
}
```

### 3. z-index 工作原理

**回答**：控制层叠顺序，值越大越靠前

**代码示例**：

```css
.layer1 { 
  position: relative;
  z-index: 1;
  background: red;
}

.layer2 {
  position: absolute;
  z-index: 2; /* 在layer1上面 */
  background: blue;
  opacity: 0.7;
}

.layer3 {
  position: fixed;
  z-index: 9999; /* 最顶层 */
  background: green;
}
```

### 4. 清除浮动方法

**代码示例**：

```plain
html
```

```plain
<div class="parent clearfix">
  <div class="float-left">浮动元素</div>
  <div class="float-left">浮动元素</div>
</div>
```

```css
/* 1. 空div清除法 */
.clear { clear: both; }

/* 2. overflow清除法 */
.parent { overflow: hidden; }

/* 3. 伪元素清除法（推荐） */
.clearfix::after {
  content: "";
  display: table;
  clear: both;
}

/* 4. 创建BFC */
.parent { display: flow-root; }
```

### 5. 浮动和绝对定位的区别

**对比表格**：

| 特性  | 浮动  | 绝对定位 |
| --- | --- | --- |
| 文档流 | 脱离文档流，但保留位置 | 完全脱离文档流 |
| 参照物 | 父元素或前面的浮动元素 | 最近非static祖先 |
| 文字环绕 | 支持  | 不支持 |
| 宽度  | 根据内容自适应 | 根据内容或指定 |

## 4.4 Flexbox 布局

### 1. 主轴和交叉轴

**代码示例**：

```css
.container {
  display: flex;
  flex-direction: row; /* 主轴水平，交叉轴垂直 */
  /* flex-direction: column; 主轴垂直，交叉轴水平 */
}
```

### 2. justify-content 和 align-items

**代码示例**：

```css
.container {
  display: flex;
  justify-content: center;    /* 主轴对齐方式 */
  align-items: center;        /* 交叉轴对齐方式 */
  
  /* 多行对齐 */
  align-content: space-between;
}

.item {
  align-self: flex-start;     /* 单个项目交叉轴对齐 */
}
```

### 3. flex: 1 的含义

**代码示例**：

```css
.item {
  flex: 1;
  /* 等价于 */
  flex-grow: 1;
  flex-shrink: 1;
  flex-basis: 0%;
}
```

### 4. flex-grow、flex-shrink、flex-basis

**代码示例**：

```css
.container {
  display: flex;
  width: 600px;
}

.item1 {
  flex: 1 1 200px;  /* grow=1, shrink=1, basis=200px */
}

.item2 {
  flex: 2 1 100px;  /* 比item1多占一倍空间 */
}

.item3 {
  flex: 0 0 150px;  /* 固定150px，不伸缩 */
}
```

### 5. 实现居中的多种方法

**代码示例**：

```css
/* 1. Flexbox居中（推荐） */
.container {
  display: flex;
  justify-content: center;  /* 水平居中 */
  align-items: center;      /* 垂直居中 */
}

/* 2. Grid居中 */
.container {
  display: grid;
  place-items: center;
}

/* 3. 绝对定位居中 */
.element {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

/* 4. margin auto居中 */
.element {
  width: 200px;
  margin: 0 auto;  /* 水平居中 */
}

/* 5. 文本居中 */
.text-center {
  text-align: center;
  line-height: 100px;  /* 垂直居中，需配合height */
}
```

## 4.5 Grid 布局

### 1. Grid vs Flexbox

**应用场景**：

*   **Grid**：二维布局，整体页面结构
    
*   **Flexbox**：一维布局，组件内部排列
    

**代码示例**：

```css
/* Grid：二维网格 */
.grid-container {
  display: grid;
  grid-template-columns: 200px 1fr 200px;
  grid-template-rows: auto 1fr auto;
  grid-template-areas:
    "header header header"
    "sidebar content ads"
    "footer footer footer";
}

/* Flexbox：一维排列 */
.navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
```

### 2. fr 单位

**代码示例**：

```css
.grid {
  display: grid;
  grid-template-columns: 1fr 2fr 1fr; /* 1:2:1比例 */
  grid-template-rows: 100px 1fr 50px;
  gap: 10px;
}
```

### 3. grid-template-areas

**代码示例**：

```css
.layout {
  display: grid;
  grid-template-areas:
    "header header header"
    "sidebar main ads"
    "footer footer footer";
  grid-template-columns: 200px 1fr 150px;
  grid-template-rows: auto 1fr auto;
}

.header { grid-area: header; }
.sidebar { grid-area: sidebar; }
.main { grid-area: main; }
.ads { grid-area: ads; }
.footer { grid-area: footer; }
```

### 4. 响应式 Grid

**代码示例**：

```css
.responsive-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
}

/* 媒体查询调整 */
@media (max-width: 768px) {
  .responsive-grid {
    grid-template-columns: 1fr;
  }
  
  .layout {
    grid-template-areas:
      "header"
      "sidebar"
      "main"
      "ads"
      "footer";
    grid-template-columns: 1fr;
  }
}
```

### 5. 网格线和网格轨道

**代码示例**：

```css
.grid {
  display: grid;
  grid-template-columns: [start] 100px [col1-end] 1fr [end];
  grid-template-rows: [row-start] auto [row-end];
  gap: 10px;
}

.item {
  grid-column: start / end;    /* 从第1列到第3列 */
  grid-row: row-start / row-end;
  
  /* 使用数字表示 */
  /* grid-column: 1 / 3; */
  /* grid-row: 1 / span 2; */
}
```

## 4.6 响应式设计

### 1. 移动端适配方案

**代码示例**：

```plain
html
```

```plain
<!-- 1. 设置viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- 2. 使用rem适配 -->
<script>
  document.documentElement.style.fontSize = 
    document.documentElement.clientWidth / 375 * 16 + 'px';
</script>
```

```css
/* 3. 媒体查询适配 */
@media (max-width: 768px) {
  .container { padding: 10px; }
}

/* 4. 使用vw/vh */
.box {
  width: 50vw;      /* 视口宽度50% */
  height: 50vh;     /* 视口高度50% */
  font-size: 4vw;   /* 响应式字体 */
}

/* 5. 使用clamp()函数 */
.responsive-text {
  font-size: clamp(14px, 2vw, 18px);
}
```

### 2. 媒体查询语法

**代码示例**：

```css
/* 基本语法 */
@media media-type and (media-feature) {
  /* CSS规则 */
}

/* 示例 */
/* 手机 */
@media screen and (max-width: 576px) {
  .container { padding: 10px; }
}

/* 平板 */
@media screen and (min-width: 577px) and (max-width: 992px) {
  .container { padding: 20px; }
}

/* 桌面 */
@media screen and (min-width: 993px) {
  .container { padding: 30px; }
}

/* 暗色模式 */
@media (prefers-color-scheme: dark) {
  body { background: #333; color: white; }
}

/* 打印样式 */
@media print {
  .no-print { display: none; }
}
```

### 3. 单位区别

**对比**：

*   **px**：绝对单位，固定像素
    
*   **em**：相对单位，相对于父元素字体
    
*   **rem**：相对单位，相对于根元素字体
    
*   **vw/vh**：相对视口宽度/高度
    
*   **%**：相对于父元素
    

**代码示例**：

```css
html { font-size: 16px; } /* 1rem = 16px */

.container {
  width: 100%;      /* 父元素宽度 */
  font-size: 20px;
}

.child {
  width: 50vw;      /* 视口宽度50% */
  height: 50vh;     /* 视口高度50% */
  padding: 1em;     /* 20px，基于父元素字体 */
  margin: 1rem;     /* 16px，基于根元素字体 */
  font-size: 1.5rem; /* 24px */
}
```

### 4. 1px 问题及解决

**问题**：Retina屏下1px显示为2物理像素

**解决方案**：

```css
/* 1. transform缩放 */
.thin-border {
  position: relative;
}
.thin-border::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 1px;
  background: #ccc;
  transform: scaleY(0.5);
  transform-origin: 0 0;
}

/* 2. viewport缩放（仅限移动端） */
<meta name="viewport" content="width=device-width, initial-scale=0.5">

/* 3. 使用border-image */
.thin-border {
  border-bottom: 1px solid transparent;
  border-image: linear-gradient(to bottom, #ccc 50%, transparent 50%) 0 0 100% 0;
}

/* 4. 使用box-shadow */
.thin-border {
  box-shadow: 0 0.5px 0 #ccc;
}

/* 5. 使用伪元素 + 媒体查询 */
@media (-webkit-min-device-pixel-ratio: 2) {
  .thin-border::after {
    transform: scaleY(0.5);
  }
}
```

### 5. Retina屏适配

**代码示例**：

```css
/* 1. 使用2x/3x图片 */
.logo {
  background-image: url(logo@1x.png);
  background-size: 100px 100px;
}

@media (-webkit-min-device-pixel-ratio: 2),
       (min-resolution: 192dpi) {
  .logo {
    background-image: url(logo@2x.png);
  }
}

/* 2. 使用srcset（HTML） */
<img src="image.jpg"
     srcset="image@2x.jpg 2x, image@3x.jpg 3x"
     alt="Retina Image">

/* 3. 使用picture元素 */
<picture>
  <source media="(min-width: 800px)" srcset="large.jpg">
  <source media="(min-width: 400px)" srcset="medium.jpg">
  <img src="small.jpg" alt="响应式图片">
</picture>

/* 4. 图标使用SVG */
.icon {
  background-image: url(icon.svg);
  background-size: contain;
}
```

## 4.7 动画与过渡

### 1. transition vs animation

**对比**：

*   **transition**：简单状态变化，需要触发
    
*   **animation**：复杂动画序列，自动播放
    

**代码示例**：

```css
/* transition：悬停效果 */
.button {
  background: blue;
  transition: all 0.3s ease;
}
.button:hover {
  background: red;
  transform: scale(1.1);
}

/* animation：加载动画 */
.loader {
  width: 50px;
  height: 50px;
  border: 3px solid #f3f3f3;
  border-top: 3px solid #3498db;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
```

### 2. transform 变换函数

**代码示例**：

```css
.element {
  /* 2D变换 */
  transform: translate(50px, 100px);  /* 移动 */
  transform: rotate(45deg);           /* 旋转 */
  transform: scale(1.5);              /* 缩放 */
  transform: skew(30deg, 20deg);      /* 倾斜 */
  
  /* 3D变换 */
  transform: translate3d(0, 0, 100px);
  transform: rotateX(45deg);
  transform: scale3d(1, 1, 2);
  
  /* 组合变换 */
  transform: translateX(50px) rotate(45deg) scale(1.2);
  
  /* 变换原点 */
  transform-origin: 0 0;
}
```

### 3. 硬件加速实现

**代码示例**：

```css
/* 触发GPU加速 */
.accelerated {
  transform: translateZ(0);      /* 常用hack */
  backface-visibility: hidden;   /* 隐藏背面 */
  perspective: 1000px;           /* 3D透视 */
}

/* 使用will-change优化 */
.element {
  will-change: transform, opacity;
}

/* 实际应用 */
.smooth-animation {
  transition: transform 0.3s ease;
  transform: translateZ(0); /* 硬件加速 */
}

.smooth-animation:hover {
  transform: translateY(-10px) translateZ(0);
}
```

### 4. 帧动画实现

**代码示例**：

```css
/* 1. steps()函数实现 */
.character {
  width: 64px;
  height: 64px;
  background-image: url(spritesheet.png);
  animation: walk 1s steps(6) infinite;
}

@keyframes walk {
  from { background-position: 0 0; }
  to { background-position: -384px 0; }
}

/* 2. 关键帧序列 */
@keyframes bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-30px);
  }
  60% {
    transform: translateY(-15px);
  }
}

.ball {
  animation: bounce 2s infinite;
}
```

### 5. will-change 作用

**代码示例**：

```css
/* 预知变化，浏览器优化 */
.element {
  will-change: transform, opacity;
  transition: transform 0.3s;
}

.element:hover {
  transform: scale(1.2);
  opacity: 0.8;
}

/* 注意：使用后需要清除 */
.element.animated {
  will-change: transform;
}

.element.done {
  will-change: auto;
}
```

## 4.8 视觉效果

### 1. 多行文本省略

**代码示例**：

```css
/* 单行省略 */
.single-line {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

/* 多行省略（WebKit） */
.multi-line {
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 3;  /* 限制行数 */
  overflow: hidden;
  line-height: 1.5;
  max-height: calc(1.5em * 3); /* 行高×行数 */
}

/* 使用伪元素渐变遮罩（通用方案） */
.fade-ellipsis {
  position: relative;
  max-height: 4.5em; /* 3行×1.5行高 */
  overflow: hidden;
  line-height: 1.5;
}

.fade-ellipsis::after {
  content: "...";
  position: absolute;
  bottom: 0;
  right: 0;
  padding-left: 20px;
  background: linear-gradient(to right, transparent, white 50%);
}
```

### 2. CSS 三角形

**代码示例**：

```css
/* 基本三角形 */
.triangle {
  width: 0;
  height: 0;
  border: 50px solid transparent;
}

/* 向下三角形 */
.triangle-down {
  border-top-color: #333;
  border-bottom: none;
}

/* 向上三角形 */
.triangle-up {
  border-bottom-color: #333;
  border-top: none;
}

/* 向左三角形 */
.triangle-left {
  border-right-color: #333;
  border-left: none;
}

/* 向右三角形 */
.triangle-right {
  border-left-color: #333;
  border-right: none;
}

/* 聊天框箭头 */
.chat-bubble {
  position: relative;
  background: #007bff;
  color: white;
  padding: 10px;
  border-radius: 5px;
}

.chat-bubble::after {
  content: "";
  position: absolute;
  top: 10px;
  left: -10px;
  border: 5px solid transparent;
  border-right-color: #007bff;
}
```

### 3. 渐变类型

**代码示例**：

```css
/* 线性渐变 */
.linear-gradient {
  background: linear-gradient(45deg, red, blue);
  background: linear-gradient(to right, #ff9a9e, #fad0c4);
  background: linear-gradient(90deg, 
    red 0%, 
    orange 25%, 
    yellow 50%, 
    green 75%, 
    blue 100%);
}

/* 径向渐变 */
.radial-gradient {
  background: radial-gradient(circle at center, red, blue);
  background: radial-gradient(ellipse at top, #a1c4fd, #c2e9fb);
}

/* 锥形渐变 */
.conic-gradient {
  background: conic-gradient(red, yellow, green, blue, red);
  background: conic-gradient(from 0deg, red 0deg 90deg, blue 90deg 180deg, green 180deg 270deg, yellow 270deg 360deg);
}

/* 重复渐变 */
.repeating-gradient {
  background: repeating-linear-gradient(45deg, #fff, #fff 10px, #eee 10px, #eee 20px);
}
```

### 4. filter 效果

**代码示例**：

```css
.image {
  filter: blur(5px);                 /* 模糊 */
  filter: brightness(150%);          /* 亮度 */
  filter: contrast(200%);            /* 对比度 */
  filter: grayscale(100%);           /* 灰度 */
  filter: hue-rotate(90deg);         /* 色相旋转 */
  filter: invert(100%);              /* 反色 */
  filter: opacity(50%);              /* 透明度 */
  filter: saturate(200%);            /* 饱和度 */
  filter: sepia(100%);               /* 怀旧 */
  
  /* 组合效果 */
  filter: grayscale(50%) blur(2px) brightness(120%);
  
  /* 阴影（与drop-shadow不同） */
  filter: drop-shadow(5px 5px 10px rgba(0,0,0,0.5));
}

/* 悬停效果 */
.hover-effect:hover {
  filter: brightness(1.2) contrast(1.1);
  transition: filter 0.3s ease;
}
```

### 5. backdrop-filter

**代码示例**：

```css
/* 毛玻璃效果 */
.modal {
  background: rgba(255, 255, 255, 0.3);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px); /* Safari支持 */
  border: 1px solid rgba(255, 255, 255, 0.2);
}

/* 导航栏毛玻璃 */
.navbar {
  position: fixed;
  top: 0;
  width: 100%;
  background: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(5px) saturate(180%);
}

/* 对话框背景 */
.dialog-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(3px);
}
```

## 4.9 性能与优化

### 1. CSS 加载阻塞

**回答**：

*   CSS不会阻塞DOM解析，但会阻塞DOM渲染
    
*   CSS会阻塞后面的JS执行（除非JS异步）
    

**代码示例**：

```plain
html
```

```plain
<!-- 优化CSS加载 -->
<!-- 1. 将CSS放在head中 -->
<head>
  <link rel="stylesheet" href="styles.css">
</head>

<!-- 2. 媒体查询优化 -->
<link rel="stylesheet" href="print.css" media="print">

<!-- 3. 异步加载CSS -->
<link rel="preload" href="styles.css" as="style" onload="this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="styles.css"></noscript>

<!-- 4. 内联关键CSS -->
<style>
  /* 关键CSS内联 */
  .above-the-fold { /* ... */ }
</style>
<link rel="preload" href="non-critical.css" as="style">
```

### 2. 减少重绘和重排

**代码示例**：

```css
/* 1. 避免频繁修改样式 */
/* 不好 */
for(let i = 0; i < 100; i++) {
  element.style.left = i + 'px';
}

/* 好 */
element.style.transform = `translateX(${i}px)`;

/* 2. 使用transform和opacity */
.element {
  transform: translateZ(0); /* 启用GPU加速 */
}

/* 3. 批量修改DOM */
// 不好
for(let i = 0; i < items.length; i++) {
  container.appendChild(items[i]);
}

// 好
const fragment = document.createDocumentFragment();
for(let i = 0; i < items.length; i++) {
  fragment.appendChild(items[i]);
}
container.appendChild(fragment);

/* 4. 避免强制同步布局 */
// 不好
const width = element.offsetWidth;
element.style.width = (width + 10) + 'px';

// 好
requestAnimationFrame(() => {
  const width = element.offsetWidth;
  element.style.width = (width + 10) + 'px';
});
```

### 3. CSS 雪碧图

**代码示例**：

```css
/* 雪碧图实现 */
.icon {
  background-image: url(sprite.png);
  background-repeat: no-repeat;
  display: inline-block;
}

.icon-home {
  width: 32px;
  height: 32px;
  background-position: 0 0;
}

.icon-user {
  width: 32px;
  height: 32px;
  background-position: -32px 0;
}

.icon-settings {
  width: 32px;
  height: 32px;
  background-position: -64px 0;
}

/* 现代替代方案：SVG雪碧图 */
.svg-sprite {
  display: none;
}

.icon-svg {
  width: 24px;
  height: 24px;
}

.icon-svg use {
  fill: currentColor;
}
```

```plain
html
```

```plain
<svg class="svg-sprite">
<symbol id="icon-home" viewBox="0 0 24 24">
<path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
</symbol>
</svg>
<svg class="icon-svg">
<use xlink:href="#icon-home">
</use>
</svg>
```

### 4. CSS 模块化和复用

**代码示例**：

```css
/* 1. BEM命名规范 */
.block { /* ... */ }
.block__element { /* ... */ }
.block--modifier { /* ... */ }

/* 2. CSS变量 */
:root {
  --primary-color: #007bff;
  --secondary-color: #6c757d;
  --spacing-unit: 8px;
  --font-family: 'Arial', sans-serif;
}

.button {
  background-color: var(--primary-color);
  padding: calc(var(--spacing-unit) * 2);
  font-family: var(--font-family);
}

/* 3. 工具类 */
.text-center { text-align: center; }
.mt-1 { margin-top: 0.25rem; }
.p-2 { padding: 0.5rem; }

/* 4. 混合和继承（Sass） */
@mixin flex-center {
  display: flex;
  justify-content: center;
  align-items: center;
}

.modal {
  @include flex-center;
  position: fixed;
  top: 0;
  left: 0;
}

/* 5. CSS Modules */
/* styles.module.css */
.button {
  composes: baseButton from './base.css';
  background: blue;
}
```

### 5. CSS-in-JS 优缺点

**代码示例**：

```jsx
// Styled-components示例
import styled from 'styled-components';

const Button = styled.button`
  background: ${props => props.primary ? 'blue' : 'white'};
  color: ${props => props.primary ? 'white' : 'blue'};
  padding: 10px 20px;
  border: 2px solid blue;
  border-radius: 5px;
  
  &:hover {
    opacity: 0.8;
  }
  
  @media (max-width: 768px) {
    padding: 8px 16px;
  }
`;

// Emotion示例
import { css } from '@emotion/react';

const style = css`
  color: hotpink;
  
  &:hover {
    color: pink;
  }
`;
```

**优缺点**：

*   **优点**：组件化、动态样式、自动前缀、代码拆分
    
*   **缺点**：运行时开销、学习成本、调试困难
    

## 4.10 现代特性

### 1. CSS 变量

**代码示例**：

```css
:root {
  /* 定义变量 */
  --primary: #007bff;
  --secondary: #6c757d;
  --success: #28a745;
  --spacing: 8px;
  --font-size: 16px;
  --border-radius: 4px;
}

/* 使用变量 */
.button {
  background-color: var(--primary);
  padding: calc(var(--spacing) * 2);
  font-size: var(--font-size);
  border-radius: var(--border-radius);
  
  /* 回退值 */
  color: var(--custom-color, black);
}

/* JS操作CSS变量 */
element.style.setProperty('--primary', '#ff0000');
const primary = getComputedStyle(element).getPropertyValue('--primary');

/* 媒体查询中的变量 */
@media (prefers-color-scheme: dark) {
  :root {
    --primary: #0d6efd;
    --background: #212529;
  }
}
```

### 2. 容器查询

**代码示例**：

```css
/* 定义容器 */
.component {
  container-type: inline-size;
  container-name: component;
}

/* 容器查询 */
@container component (min-width: 400px) {
  .card {
    display: flex;
    gap: 20px;
  }
}

@container component (min-width: 600px) {
  .card {
    flex-direction: column;
  }
  
  .card-image {
    width: 100%;
    height: 200px;
  }
}

/* 简写语法 */
.component {
  container: component / inline-size;
}

/* 实际应用：卡片组件 */
.card {
  border: 1px solid #ddd;
  padding: 16px;
}

@container (min-width: 500px) {
  .card {
    display: grid;
    grid-template-columns: 200px 1fr;
    gap: 20px;
  }
}
```

### 3. :has() 选择器

**代码示例**：

```css
/* 选择包含特定子元素的父元素 */
.container:has(.active) {
  border: 2px solid blue;
}

/* 选择包含空元素的父元素 */
.list:has(li:empty) {
  opacity: 0.5;
}

/* 选择后面有特定兄弟的元素 */
h1:has(+ p) {
  margin-bottom: 0.5em;
}

/* 实际应用：表单验证 */
.form-group:has(input:invalid) {
  background-color: rgba(255, 0, 0, 0.1);
}

.form-group:has(input:valid) {
  background-color: rgba(0, 255, 0, 0.1);
}

/* 卡片悬停效果 */
.card:has(img:hover) {
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

/* 选择有子菜单的导航项 */
.nav-item:has(.submenu)::after {
  content: "▼";
  margin-left: 5px;
}
```

### 4. CSS 嵌套语法

**代码示例**：

```css
/* 传统写法 */
.card { /* ... */ }
.card .title { /* ... */ }
.card:hover .title { /* ... */ }

/* 嵌套写法 */
.card {
  border: 1px solid #ddd;
  padding: 1rem;
  
  .title {
    font-size: 1.5rem;
    color: #333;
    
    &:hover {
      color: blue;
    }
  }
  
  &:hover {
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  @media (min-width: 768px) {
    display: flex;
    gap: 1rem;
  }
}

/* & 符号的作用 */
.button {
  background: blue;
  
  &--primary {
    background: darkblue;
  }
  
  &__icon {
    margin-right: 0.5rem;
  }
  
  &:disabled {
    opacity: 0.5;
  }
}

/* 嵌套媒体查询 */
.component {
  width: 100%;
  
  @container (min-width: 500px) {
    width: 50%;
  }
}
```

### 5. 子网格（subgrid）

**代码示例**：

```css
/* 父网格 */
.grid-container {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: auto 1fr auto;
  gap: 20px;
  padding: 20px;
}

/* 子网格继承父网格 */
.grid-item {
  display: grid;
  grid-template-columns: subgrid;
  grid-template-rows: subgrid;
  grid-column: span 2; /* 占据两列 */
  gap: inherit; /* 继承gap */
}

/* 实际应用：卡片布局 */
.card {
  display: grid;
  grid-template-rows: subgrid;
  grid-row: span 3;
  
  .card-header {
    grid-row: 1;
  }
  
  .card-content {
    grid-row: 2;
  }
  
  .card-footer {
    grid-row: 3;
  }
}

/* 复杂布局示例 */
.dashboard {
  display: grid;
  grid-template-columns: 250px 1fr 300px;
  grid-template-rows: auto 1fr auto;
  height: 100vh;
}

.sidebar {
  grid-column: 1;
  grid-row: 1 / -1;
  display: grid;
  grid-template-rows: subgrid;
  
  .logo { grid-row: 1; }
  .nav { grid-row: 2; }
  .user-info { grid-row: 3; }
}
```


## 自己总结的面试题

### 1. 怎样保证元素居中？


1. Flexbox（最常用）
    
    ```css
    .parent {
        display: flex;
        justify-content: center;  /* 水平 */
        align-items: center;      /* 垂直 */
        
        /* 单行简写 */
        place-content: center;
    }
    ```

2. Grid（代码最简洁）
    
    ```css
    .parent {
        display: grid;
        place-items: center;  /* 一行搞定 */
        
        /* 或者分开写 */
        justify-content: center;
        align-content: center;
    }
    ```

3. 定位 + Transform（兼容性好）
    
    ```css
    .parent {
        position: relative;
    }

    .child {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);  /* 关键：反向偏移 */
    }
    ```
4. 旧方案

    - 行内/行内块元素

    ```css
    .parent {
        text-align: center;  /* 父元素设置 */
    }

    .inline-element {
        display: inline-block;
    }
    ```
    - 块级元素

    ```css
    .block-element {
        width: 200px;
        margin: 0 auto;  /* 关键：左右auto */
    }
    ```
## 一、Cron表达式基本格式


```markdown
*    *    *    *    *    *
┬    ┬    ┬    ┬    ┬    ┬
│    │    │    │    │    └── 星期几 (0-7) (0和7都表示周日)
│    │    │    │    └───── 月份 (1-12)
│    │    │    └────────── 日期 (1-31)
│    │    └─────────────── 小时 (0-23)
│    └──────────────────── 分钟 (0-59)
└───────────────────────── 秒 (0-59) [部分系统可选]
```

## 二、Java/Spring中的使用

### 1. **Spring框架**​ (`@Scheduled`注解)

```java
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;

@Component
public class MyScheduledTask {
    
    // 每天10:00执行
    @Scheduled(cron = "0 0 10 * * ?")
    public void dailyTask() {
        // 任务逻辑
    }
    
    // 每5分钟执行一次
    @Scheduled(cron = "0 */5 * * * ?")
    public void everyFiveMinutes() {
        // 任务逻辑
    }
    
    // 工作日的9:00-17:00每小时执行
    @Scheduled(cron = "0 0 9-17 ? * MON-FRI")
    public void workHourTask() {
        // 任务逻辑
    }
}
```

**Spring配置**：

```java
@Configuration
@EnableScheduling
public class SchedulingConfig {
    // 启用定时任务
}
```

### 2. **Quartz Scheduler**​ (企业级)

```java
// 创建Job
public class MyJob implements Job {
    @Override
    public void execute(JobExecutionContext context) {
        // 任务逻辑
    }
}

// 调度器配置
Scheduler scheduler = StdSchedulerFactory.getDefaultScheduler();
JobDetail job = JobBuilder.newJob(MyJob.class)
    .withIdentity("myJob", "group1")
    .build();

Trigger trigger = TriggerBuilder.newTrigger()
    .withIdentity("myTrigger", "group1")
    .withSchedule(CronScheduleBuilder.cronSchedule("0 0/30 9-17 * * ?"))
    .build();

scheduler.scheduleJob(job, trigger);
scheduler.start();
```

## 三、Python中的使用

### 1. **APScheduler库**


```python
from apscheduler.schedulers.background import BackgroundScheduler
from datetime import datetime

scheduler = BackgroundScheduler()

# 每天10:30执行
@scheduler.scheduled_job('cron', hour=10, minute=30)
def job1():
    print(f"任务执行: {datetime.now()}")

# 使用cron表达式
@scheduler.scheduled_job('cron', minute='*/15')
def job2():
    print(f"每15分钟执行: {datetime.now()}")

# 或者用字符串表达式
scheduler.add_job(job3, 'cron', minute='*/5', hour='9-18', day_of_week='mon-fri')

scheduler.start()
```

### 2. **Celery**​ (Django/Flask)


```python
# Django + Celery
from celery import shared_task
from celery.schedules import crontab

@shared_task
def my_task():
    print("定时任务执行")

# celery.py配置
app.conf.beat_schedule = {
    'daily-task': {
        'task': 'myapp.tasks.my_task',
        'schedule': crontab(hour=7, minute=30),  # 每天7:30
    },
    'hourly-task': {
        'task': 'myapp.tasks.another_task',
        'schedule': crontab(minute=0, hour='*/1'),  # 每小时
    },
}
```

## 四、JavaScript/Node.js中的使用

### 1. **node-cron库**



```javascript
const cron = require('node-cron');

// 每5分钟执行
cron.schedule('*/5 * * * *', () => {
    console.log('每5分钟执行一次');
});

// 工作日的9点到17点每小时执行
cron.schedule('0 9-17 * * 1-5', () => {
    console.log('工作日每小时执行');
});

// 更复杂的表达式
cron.schedule('0 0 1,15 * *', () => {
    console.log('每月1号和15号执行');
});
```

### 2. **Agenda**​ (MongoDB-based)



```javascript
const Agenda = require('agenda');
const agenda = new Agenda({ db: { address: 'mongodb://localhost/agenda' } });

agenda.define('send email report', async job => {
    // 发送邮件逻辑
});

// 每天8:00执行
agenda.every('0 8 * * *', 'send email report');

// 每月第一天
agenda.every('0 0 1 * *', 'generate monthly report');
```

## 五、Go语言中的使用

### 1. **robfig/cron库**



```go
package main

import (
    "fmt"
    "github.com/robfig/cron/v3"
)

func main() {
    c := cron.New()
    
    // 每天10:00执行
    c.AddFunc("0 0 10 * * *", func() {
        fmt.Println("每天10:00执行")
    })
    
    // 每30分钟执行一次
    c.AddFunc("*/30 * * * *", func() {
        fmt.Println("每30分钟执行")
    })
    
    // 工作日的9-17点每小时执行
    c.AddFunc("0 9-17 * * 1-5", func() {
        fmt.Println("工作日每小时执行")
    })
    
    c.Start()
    defer c.Stop()
    
    select {} // 保持程序运行
}
```

## 六、C#/.NET中的使用

### 1. **Hangfire库**

```csharp
// 每天凌晨1点执行
RecurringJob.AddOrUpdate<IMyService>(
    "daily-job",
    service => service.DailyTask(),
    "0 1 * * *");

// 每5分钟执行
RecurringJob.AddOrUpdate(
    "minute-job",
    () => Console.WriteLine("每5分钟"),
    "*/5 * * * *");

// 每周一9:00
RecurringJob.AddOrUpdate(
    "weekly-job",
    () => SendWeeklyReport(),
    "0 9 * * 1");
```

### 2. **Quartz.NET**

```csharp
IJobDetail job = JobBuilder.Create<HelloJob>()
    .WithIdentity("job1", "group1")
    .Build();

ITrigger trigger = TriggerBuilder.Create()
    .WithIdentity("trigger1", "group1")
    .WithCronSchedule("0 0/5 9-17 * * ?")
    .ForJob("job1", "group1")
    .Build();

scheduler.ScheduleJob(job, trigger);
```

## 七、PHP中的使用

### 1. **Laravel任务调度**

```php
// app/Console/Kernel.php
protected function schedule(Schedule $schedule)
{
    // 每天凌晨1点执行
    $schedule->command('report:generate')
             ->dailyAt('01:00');
    
    // 每5分钟执行
    $schedule->command('queue:work')
             ->everyFiveMinutes();
    
    // 使用cron表达式
    $schedule->command('backup:run')
             ->cron('0 2 * * 0');  // 每周日凌晨2点
}
```

## 八、常用Cron表达式示例

| 表达式 | 说明  | 适用场景 |
| --- | --- | --- |
| `0 0 * * *` | 每天0点 | 日统计任务 |
| `0 */2 * * *` | 每2小时 | 缓存刷新 |
| `*/5 * * * *` | 每5分钟 | 监控检查 |
| `0 9-18 * * 1-5` | 工作日的9-18点每小时 | 工作时段任务 |
| `0 0 1 * *` | 每月1号0点 | 月账单生成 |
| `0 0 * * 0` | 每周日0点 | 周报生成 |
| `0 2 * * 6` | 每周六凌晨2点 | 数据备份 |
